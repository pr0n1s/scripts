#!/usr/bin/env python

from stat import  *
import os, time 
import sys

# gets the following information from file:
#   - file size
#   - last modified time
#   - last accessed time
#   - last changed time (data)
# returns: 
#   - a tuple of 4 values
def fileInfo(fp):
  try:
    # st = stats
    st = os.stat(fp)
  
  except IOError:
      print('Failed to retrieve information from file: %s'%fp)

  else:
    # return: file size, last modified time, last accessed time, last changed time, 
    # respectively
    return (st[ST_SIZE], time.asctime(time.localtime(st[ST_MTIME])), 
            time.asctime(time.localtime(st[ST_ATIME])), 
            time.asctime(time.localtime(st[ST_CTIME]))) 

def main():
  try:
   # rd = root directory, taken from command line
   rd = str(sys.argv[1])

   # d = dir, sd = subdir, f = files
   for d, sd, f in os.walk(rd):
     print('Dir: %s'%d)
    
     print('\n\tFiles: ')
     for fn in f:
       print('\t\t%s'%fn)

       # full path to file
       fp = d + '/' + fn

       # unpack the tuple returned from the fileInfo function
       size, modTime, lastAccess, lastChange  = fileInfo(fp)
       print('\t\t\tfile size:     %s'%size + ' bytes\n' + 
             '\t\t\tlast modified: %s\n'%modTime +  
             '\t\t\tlast accessed: %s\n'%lastAccess +
             '\t\t\tlast change:   %s\n'%lastChange + '\n')

  except:
   print('Usage: /full/path/to-dir')

if __name__ == '__main__':
  main()
